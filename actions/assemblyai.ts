"use server";
import { AssemblyAI } from "assemblyai";

const client = new AssemblyAI({
  apiKey: process.env.ASSEMBLY_API_KEY!,
});

// const captionsArray = [
//   {
//     text: "Once",
//     start: 360,
//     end: 496,
//     confidence: 0.99954,
//     speaker: null,
//   },
//   {
//     text: "upon",
//     start: 496,
//     end: 728,
//     confidence: 0.98591,
//     speaker: null,
//   },
//   {
//     text: "a",
//     start: 728,
//     end: 904,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "time,",
//     start: 904,
//     end: 1240,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "there",
//     start: 1297,
//     end: 1497,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "was",
//     start: 1521,
//     end: 1681,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "a",
//     start: 1713,
//     end: 1857,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "young",
//     start: 1881,
//     end: 2089,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "person",
//     start: 2137,
//     end: 2465,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "struggling",
//     start: 2545,
//     end: 2865,
//     confidence: 0.7594,
//     speaker: null,
//   },
//   {
//     text: "with",
//     start: 2905,
//     end: 3081,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "a",
//     start: 3113,
//     end: 3257,
//     confidence: 0.99975,
//     speaker: null,
//   },
//   {
//     text: "tough",
//     start: 3281,
//     end: 3617,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "challenge.",
//     start: 3681,
//     end: 4481,
//     confidence: 0.6223,
//     speaker: null,
//   },
//   {
//     text: "They",
//     start: 4673,
//     end: 4977,
//     confidence: 0.99997,
//     speaker: null,
//   },
//   {
//     text: "felt",
//     start: 5001,
//     end: 5313,
//     confidence: 0.5296,
//     speaker: null,
//   },
//   {
//     text: "lost",
//     start: 5369,
//     end: 5609,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "and",
//     start: 5657,
//     end: 5817,
//     confidence: 0.99932,
//     speaker: null,
//   },
//   {
//     text: "alone,",
//     start: 5841,
//     end: 6297,
//     confidence: 0.99224,
//     speaker: null,
//   },
//   {
//     text: "like",
//     start: 6401,
//     end: 6689,
//     confidence: 0.99893,
//     speaker: null,
//   },
//   {
//     text: "giving",
//     start: 6737,
//     end: 6945,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "up",
//     start: 6985,
//     end: 7185,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "was",
//     start: 7225,
//     end: 7377,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "the",
//     start: 7401,
//     end: 7537,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "only",
//     start: 7561,
//     end: 7817,
//     confidence: 1,
//     speaker: null,
//   },
//   {
//     text: "option.",
//     start: 7881,
//     end: 8565,
//     confidence: 0.88718,
//     speaker: null,
//   },
//   {
//     text: "But",
//     start: 8945,
//     end: 9281,
//     confidence: 0.99983,
//     speaker: null,
//   },
//   {
//     text: "then",
//     start: 9313,
//     end: 9625,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "they",
//     start: 9705,
//     end: 9921,
//     confidence: 0.99995,
//     speaker: null,
//   },
//   {
//     text: "took",
//     start: 9953,
//     end: 10121,
//     confidence: 1,
//     speaker: null,
//   },
//   {
//     text: "a",
//     start: 10153,
//     end: 10297,
//     confidence: 0.99997,
//     speaker: null,
//   },
//   {
//     text: "moment",
//     start: 10321,
//     end: 10545,
//     confidence: 0.99692,
//     speaker: null,
//   },
//   {
//     text: "to",
//     start: 10585,
//     end: 10737,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "look",
//     start: 10761,
//     end: 10897,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "up",
//     start: 10921,
//     end: 11057,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "at",
//     start: 11081,
//     end: 11217,
//     confidence: 0.99976,
//     speaker: null,
//   },
//   {
//     text: "the",
//     start: 11241,
//     end: 11425,
//     confidence: 0.99994,
//     speaker: null,
//   },
//   {
//     text: "sky",
//     start: 11465,
//     end: 11729,
//     confidence: 0.99997,
//     speaker: null,
//   },
//   {
//     text: "and",
//     start: 11777,
//     end: 11961,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "saw",
//     start: 11993,
//     end: 12137,
//     confidence: 0.9999,
//     speaker: null,
//   },
//   {
//     text: "a",
//     start: 12161,
//     end: 12297,
//     confidence: 0.99343,
//     speaker: null,
//   },
//   {
//     text: "sunrise.",
//     start: 12321,
//     end: 13165,
//     confidence: 0.99742,
//     speaker: null,
//   },
//   {
//     text: "That",
//     start: 13545,
//     end: 13905,
//     confidence: 0.99985,
//     speaker: null,
//   },
//   {
//     text: "sunrise",
//     start: 13945,
//     end: 14409,
//     confidence: 0.62033,
//     speaker: null,
//   },
//   {
//     text: "gave",
//     start: 14457,
//     end: 14641,
//     confidence: 0.98593,
//     speaker: null,
//   },
//   {
//     text: "them",
//     start: 14673,
//     end: 14817,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "the",
//     start: 14841,
//     end: 15001,
//     confidence: 0.99992,
//     speaker: null,
//   },
//   {
//     text: "strength",
//     start: 15033,
//     end: 15305,
//     confidence: 0.91488,
//     speaker: null,
//   },
//   {
//     text: "to",
//     start: 15345,
//     end: 15497,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "keep",
//     start: 15521,
//     end: 15705,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "going.",
//     start: 15745,
//     end: 16281,
//     confidence: 0.99995,
//     speaker: null,
//   },
//   {
//     text: "And",
//     start: 16433,
//     end: 16697,
//     confidence: 0.99961,
//     speaker: null,
//   },
//   {
//     text: "they",
//     start: 16721,
//     end: 16905,
//     confidence: 0.99993,
//     speaker: null,
//   },
//   {
//     text: "realized,",
//     start: 16945,
//     end: 17545,
//     confidence: 0.67695,
//     speaker: null,
//   },
//   {
//     text: "even",
//     start: 17665,
//     end: 17945,
//     confidence: 0.99986,
//     speaker: null,
//   },
//   {
//     text: "in",
//     start: 17985,
//     end: 18113,
//     confidence: 0.99994,
//     speaker: null,
//   },
//   {
//     text: "the",
//     start: 18129,
//     end: 18257,
//     confidence: 0.99996,
//     speaker: null,
//   },
//   {
//     text: "darkest",
//     start: 18281,
//     end: 18649,
//     confidence: 0.98587,
//     speaker: null,
//   },
//   {
//     text: "of",
//     start: 18697,
//     end: 18905,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "times,",
//     start: 18945,
//     end: 19409,
//     confidence: 0.99985,
//     speaker: null,
//   },
//   {
//     text: "hope",
//     start: 19537,
//     end: 19873,
//     confidence: 0.99997,
//     speaker: null,
//   },
//   {
//     text: "can",
//     start: 19929,
//     end: 20097,
//     confidence: 0.99998,
//     speaker: null,
//   },
//   {
//     text: "always",
//     start: 20121,
//     end: 20401,
//     confidence: 0.99995,
//     speaker: null,
//   },
//   {
//     text: "be",
//     start: 20473,
//     end: 20681,
//     confidence: 0.99999,
//     speaker: null,
//   },
//   {
//     text: "found.",
//     start: 20713,
//     end: 20785,
//     confidence: 0.99995,
//     speaker: null,
//   },
// ];

export async function generateCaptions(audioFileUrl: string) {
  try {
    const data = {
      audio_url: audioFileUrl,
    };

    const transcript: any = await client.transcripts.transcribe(data);
    console.log(transcript.words);
    return transcript.words;
    // return captionsArray;
  } catch (err: any) {
    console.log(err);
    throw new Error(err);
  }
}
